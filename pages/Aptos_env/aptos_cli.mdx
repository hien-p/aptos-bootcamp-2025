

![](../assets/aptos_env/setting_up_aptos_dev.png)

# Set up Aptos Environment 

## Install Aptos CLI

ƒê·ªÉ c√†i ƒë·∫∑t Aptos CLI cho system c·ªßa b·∫°n, h√£y truy c·∫≠p c√°c link sau:
- [**MAC**](https://aptos.dev/en/build/cli/install-cli/install-cli-mac)
- [**Windows**](https://aptos.dev/en/build/cli/install-cli/install-cli-windows)
- [**Linux**](https://aptos.dev/en/build/cli/install-cli/install-cli-linux)

Ki·ªÉm tra c√†i ƒë·∫∑t b·∫±ng c√°ch m·ªü terminal v√† g√µ l·ªánh:
```rust
 aptos --version
```

B√¢y gi·ªù b·∫°n ƒë√£ s·∫µn s√†ng v·ªõi c√°c c√¥ng c·ª• üõ†Ô∏è ƒë·ªÉ x√¢y d·ª±ng s·∫£n ph·∫©m c·ªßa m√¨nh tr√™n Aptos! 

ƒê√¢y l√† t√†i li·ªáu t·ª´ Aptos document: https://aptos.dev/cli-tools/aptos-cli-tool/install-aptos-cli

**Gi·∫£ s·ª≠ g·∫∑p l·ªói**, <span style={{ color: 'red', fontWeight: 500 }}>b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng m·ªôt c√°ch kh√°c l√† c√†i ƒë·∫∑t package ƒë√£ pre-compiled ƒë·ªÉ ti·∫øt ki·ªám th·ªùi gian h∆°n</span>


![](../assets/aptos_env/aptos_release.png)

- Truy c·∫≠p [trang release](https://github.com/aptos-labs/aptos-core/releases) c·ªßa Aptos CLI. # T·∫£i file n√©n
- T·∫£i b·∫£n release m·ªõi nh·∫•t 
- ƒê·∫∑t file v√†o th∆∞ m·ª•c ƒë·ªÉ ch·∫°y, v√≠ d·ª• `~/bin/aptos` tr√™n Linux. #Sau khi gi·∫£i n√©n, copy aptos v√†o th∆∞ m·ª•c n√†y
- Tr√™n Linux v√† Mac, c·∫•p quy·ªÅn th·ª±c thi b·∫±ng l·ªánh `chmod +x ~/bin/aptos` #C·∫•p quy·ªÅn cho file
- G√µ `~/bin/aptos help` ƒë·ªÉ xem h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng.
- N·∫øu mu·ªën, b·∫°n c√≥ th·ªÉ th√™m `~/bin.bashrc.zshrc` v√†o PATH trong file config ph√π h·ª£p ƒë·ªÉ d√πng sau n√†y.



![](../assets/aptos_env/aptos_cli_image.png)

C√°c b∆∞·ªõc ƒë·ªÉ t·∫°o m·ªôt d·ª± √°n blockchain th∆∞·ªùng g·ªìm c√°c thao t√°c c∆° b·∫£n sau.

T·∫°o folder v√† vi·∫øt file smart contract. B·∫°n c√≥ th·ªÉ tham kh·∫£o c·∫•u tr√∫c th∆∞ m·ª•c c·ªßa m√¨nh v√† t·∫°o c√°c folder, file t∆∞∆°ng ·ª©ng.


## Kh·ªüi t·∫°o Aptos CLI

```bash
$ aptos init
Configuring for profile default
Enter your rest endpoint [Current: None | No input: https://fullnode.devnet.aptoslabs.com]

No rest url given, using https://fullnode.devnet.aptoslabs.com...
Enter your faucet endpoint [Current: None | No input: https://faucet.devnet.aptoslabs.com]

No faucet url given, using https://faucet.devnet.aptoslabs.com...
Enter your private key as a hex literal (0x...) [Current: None | No input: Generate new key (or keep one if present)]

No key given, generating key...
Account 50A49D913AA6381C01579E3FC00784B49AFA3A771F06389EBC65F8FF3A4E9A7D doesn't exist, creating it and funding it with 10000 coins
Aptos is now set up for account 50A49D913AA6381C01579E3FC00784B49AFA3A771F06389EBC65F8FF3A4E9A7D!  Run `aptos help` for more information about commands

{
  "Result": "Success"
}
```

> M·ªôt th∆∞ m·ª•c local t√™n .aptos/ s·∫Ω ƒë∆∞·ª£c t·∫°o ra c√πng v·ªõi file config.yaml ƒë·ªÉ l∆∞u tr·ªØ c√°c c·∫•u h√¨nh trong qu√° tr√¨nh ch·∫°y CLI. ƒê√¢y l√† file local trong runtime c·ªßa b·∫°n, n√™n b·∫°n c·∫ßn ti·∫øp t·ª•c ch·∫°y CLI t·ª´ th∆∞ m·ª•c n√†y, ho·∫∑c kh·ªüi t·∫°o l·∫°i ·ªü th∆∞ m·ª•c kh√°c.

###  Start a local test network and configure the CLI

Start the local test chain:

```bash
$ aptos node run-local-testnet --with-faucet
Building genesis with 1 validators. Directory of output: "/Users/liaohua/aptos/.aptos/testnet"
Completed generating configuration:
	Log file: "/Users/liaohua/aptos/.aptos/testnet/validator.log"
	Test dir: "/Users/liaohua/aptos/.aptos/testnet"
	Aptos root key path: "/Users/liaohua/aptos/.aptos/testnet/mint.key"
	Waypoint: 0:81bffa64e06416fe9978f1e91d9f58e222836d303a3984dbd470d2c821a743b2
	ChainId: testing
	REST API endpoint: http://0.0.0.0:8080
	Metrics endpoint: http://0.0.0.0:9101/metrics
	FullNode network: /ip4/0.0.0.0/tcp/6181
Aptos is running, press ctrl-c to exit
Faucet is running.  Faucet endpoint: 0.0.0.0:8081
```

T·∫°o c·∫•u h√¨nh t√†i kho·∫£n m·ªõi cho CLI. L∆∞u √Ω l√† kh√¥ng ƒë∆∞·ª£c ƒë√≥ng c·ª≠a s·ªï l·ªánh ph√≠a tr√™n:

```bash 
$ aptos init --profile local --rest-url http://localhost:8080 --faucet-url http://localhost:8081
Configuring for profile local
Using command line argument for rest URL http://localhost:8080/
Using command line argument for faucet URL http://localhost:8081/
Enter your private key as a hex literal (0x...) [Current: None | No input: Generate new key (or keep one if present)]

No key given, generating key...
Account 4a327db3bce440f47d65b293a9688a7fd59e69a3cc1ddf0b2889a3e4f6d4de62 doesn't exist, creating it and funding it with 10000 coins
Aptos is now set up for account 4a327db3bce440f47d65b293a9688a7fd59e69a3cc1ddf0b2889a3e4f6d4de62!  Run `aptos help` for more information about commands
{
  "Result": "Success"
}
```

Reset local test chain:
```bash
$ aptos node run-local-testnet --with-faucet --force-restart
```

### Account Management

```bash 
$ aptos account fund-with-faucet
{
  "Result": "Added 100000000 Octas to account 0x3cd1d08a50289839fcf5a864e1d1eba5a22e2e6e50b7ba9c8501a317b49ac777"
}

$ aptos account create-resource-account --seed 1
Do you want to submit a transaction for a range of [97300 - 145900] Octas at a gas unit price of 100 Octas? [yes/no] >
yes
Transaction submitted: https://explorer.aptoslabs.com/txn/0xc4d69480c1e921488bfeaae4e6cfe9da46d6ad33198c9c2ba5314b99b0e12d3b?network=local
{
  "Result": {
    "resource_account": "4c83a95ae6040126c227c93f091fb36db1514d758c0173a173aae302574c65bb",
    "transaction_hash": "0xc4d69480c1e921488bfeaae4e6cfe9da46d6ad33198c9c2ba5314b99b0e12d3b",
    "gas_used": 973,
    "gas_unit_price": 100,
    "sender": "3cd1d08a50289839fcf5a864e1d1eba5a22e2e6e50b7ba9c8501a317b49ac777",
    "sequence_number": 0,
    "success": true,
    "timestamp_us": 1736913741893313,
    "version": 47986,
    "vm_status": "Executed successfully"
  }
}

```

Resource Account l√† t√†i kho·∫£n m√† quy·ªÅn s·ªü h·ªØu ƒë∆∞·ª£c ki·ªÉm so√°t b·ªüi m·ªôt resource v√† c√≥ th·ªÉ ƒë∆∞·ª£c l∆∞u tr·ªØ trong m·ªôt t√†i kho·∫£n. Th√¥ng qua Resource Account ch√∫ng ta c√≥ th·ªÉ tri·ªÉn khai c√°c ch·ª©c nƒÉng t∆∞∆°ng t·ª± nh∆∞ t√†i kho·∫£n h·ª£p ƒë·ªìng trong Solidity.



### Resource View

ƒê·ªÉ xem resource c√°c b·∫°n c√≥ th·ªÉ d√πng l·ªánh n√†y: 

```bash 
aptos account list --query resources --account default 
{
  "Result": [
    {
      "0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>": {
        "coin": {
          "value": "10000"
        },
        ...
]}

# ho·∫∑c d√πng account list th√¥i 
```

### Module view 

C√≥ nhi·ªÅu lo·∫°i truy v·∫•n kh√°c nhau ƒë·ªÉ xem c√°c project kh√°c nhau trong m·ªôt t√†i kho·∫£n. Hi·ªán t·∫°i ch·ªâ h·ªó tr·ª£ truy v·∫•n "resources" v√† "modules", nh∆∞ng s·∫Ω c√≥ th√™m nhi·ªÅu lo·∫°i truy v·∫•n m·ªõi trong t∆∞∆°ng lai. V√≠ d·ª•, ƒë·ªÉ xem c√°c module:

```rust 
$ aptos account list --query modules
```

### Transfer by aptos cli 



### Contract Compilation


M√¨nh t·∫°o m·ªôt code `HelloAptos.move` v·ªõi module nh∆∞ sau: 

```rust 
module HelloAptos::Message{

  use std::string;
  use std::error;
  use std::debug;
  use aptos_std::event;
  use std::signer;
  struct  Message has key{
      msg:string::String,
      message_change_events: event::EventHandle<MessageEvent>,
  }
  struct MessageEvent has drop, store {
      from_message: string::String,
      to_message: string::String,
  }

  const ENO_MESSAGE: u64 = 0;

  public entry fun  say_message(account:&signer, message_bytes: vector<u8>) acquires Message {
      let message = string::utf8(message_bytes);
      let account_addr = signer::address_of(account);
      if (!exists<Message>(account_addr)) {
          debug::print(&account_addr);
          move_to(account, Message {
             msg:message,
             message_change_events: event::new_event_handle<MessageEvent>(account),
          });
      } else {
          // debug::print(message);
          let old_message = borrow_global_mut<Message>(account_addr);
          let from_message = *&old_message.msg;
          event::emit_event(&mut old_message.message_change_events, MessageEvent {
              from_message,
              to_message: copy message,
          });
          old_message.msg = message;
      }

  }
  public fun get_message(addr: address): string::String acquires Message {
      assert!(exists<Message>(addr), error::not_found(ENO_MESSAGE));
      *&borrow_global<Message>(addr).msg
  }

  #[test(account = @0x1)]
  public entry fun sender_can_set_message(account: signer) acquires Message {
      let addr = signer::address_of(&account);
      say_message(&account,  b"Hello, Aptos");

      assert!(
        get_message(addr) == string::utf8(b"Hello, Aptos"),
        ENO_MESSAGE
      );
  }
}
```

V√† move.toml: 

```rust 
[package]
name = "hello-aptos"
version = "0.0.0"
[dependencies]
AptosFramework = { git = "https://github.com/aptos-labs/aptos-core.git", subdir = "aptos-move/framework/aptos-framework/", rev = "devnet" }
[addresses]
HelloAptos = "fbd4140a63e8fe7d6e9e25aff78e11876b1b6c21bc8d34b51cbfff40ca03164b" 
```

> Trong ƒë√≥ fbd4140a63e8fe7d6e9e25aff78e11876b1b6c21bc8d34b51cbfff40ca03164b c·∫ßn ƒë∆∞·ª£c thay th·∫ø b·∫±ng th√¥ng tin t√†i kho·∫£n c·ªßa b·∫°n.
